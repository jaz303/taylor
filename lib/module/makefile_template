.PHONY: clean

all: build/{{ mod.getLibraryFilename() }} build/{{ mod.getModuleFilename() }}

build:
	mkdir -p build

build/{{ mod.getLibraryFilename() }}:
	swift \
		-emit-library
		{{ mod.getSwiftCompileFlags() }} \
		-o build/{{ mod.getLibraryFilename() }} \
		{{ mod.getSwiftSourceFiles().join(' ') }}

build/{{ mod.getModuleFilename() }}:
	swift \
		-c \
		{{ mod.getSwiftCompileFlags() }} \
		-module-name {{ mod.getModuleName() }} \
		-emit-dependencies \
		-emit-module \
		-emit-module-path build/{{ mod.getModuleFilename() }} \
		-emit-objc-header \
		-emit-objc-header-path build/{{ mod.getSwiftObjCHeaderFilename() }} \
		{{ mod.getSwiftSourceFiles().join(' ') }}

clean:
	rm -rf build
